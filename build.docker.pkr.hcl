build {
  name        = "${local.name}-docker"
  description = local.description

  sources = [
    "source.docker.alpine"
  ]

  provisioner "shell" {
    environment_vars = ["PIP_ROOT_USER_ACTION=ignore"]
    scripts          = local.tools
  }

  provisioner "shell" {
    /* Fix permissions */
    inline = ["chown -R root:root /opt"]
  }

  post-processor "docker-tag" {
    repository = local.docker_tag
  }
}

